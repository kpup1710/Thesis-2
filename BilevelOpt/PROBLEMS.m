global options paddingbd epsilon hatd A b g f h n p g;
format long;
switch PROBLEM_SET
case 1 % Benson 2005
f{1} = @(x) ((x(1) + 1)/(-x(1)^2 + 3*x(1) - x(2)^2 + 3 * x(2) + 3.5));
f{2} = @(x) ((x(1)^2 - 2 * x(1) + x(2)^2 - 8 * x(2) + 20)/x(2));
g = @(x)-1;
A = [-1 0; 0 -1; 2 1; 3 1; 1 -1];
b = [-1; -1; 6; 8; 1];
paddingbd = [2;2];
epsilon = 0.01;
hatd = [1; 1];

case 2 % triobjective convex
f{1} = @(x) (x(1)^2 + x(2)^2 + x(3)^2 + 10*x(2) - 120*x(3));
f{2} = @(x) (x(1)^2 + x(2)^2 + x(3)^2 + 80*x(1) - 448*x(2) + 80*x(3));
f{3} = @(x) (x(1)^2 + x(2)^2 + x(3)^2 - 448*x(1) + 80*x(2) + 80*x(3));
g = @(x) x(1)^2 + x(2)^2 + x(3)^2 - 100;
A = [-1 0 0; 0 -1 0; 0 0 -1; 1 0 0; 0 1 0; 0 0 1];
b = [0; 0; 0; 10; 10; 10];
paddingbd = [2000;8000;7000];
epsilon = 1e-8;
hatd= [0.2;1;1];

case 3 % Wang2011
f{1} = @(x) (-x(1)+2*x(2)+2)/(3*x(1)-4*x(2)+5);
f{2} = @(x) (4*x(1)-3*x(2)+4)/(-2*x(1)+x(2)+3);
g = @(x)-1;
A = [-1 0; 0 -1; 1 0; 0 1; 1 1];
b = [0;0;1;1;1.5];
paddingbd = [10;10];
epsilon = 1e-5;
hatd= [1;1];

%% Example of inner approximation
case 4 % Benson 2005
f{1} = @(x) ((3*x(1) + x(2))^2/(3*x(1) + x(2)-1)^3);
f{2} = @(x) ((x(1)^2 - 2 * x(1) + x(2)^2 - 8 * x(2))/(x(2)+1));
h = @(x) (2*x(1)+3*x(2))/ (4*x(1) + 5*x(2) + 10);
g = @(x) -1;
A = [-1 0; 0 -1; 2 1; 3 1; 1 -1];
b = [-1; -1; 6; 8; 1];
% paddingbd = [2;2];
epsilon = 1e-2;
hatd = [1; 1];

case 5 % Wang2011
f{1} = @(x) (-x(1)+2*x(2)+2)/(3*x(1)-4*x(2)+5);
f{2} = @(x) (4*x(1)-3*x(2)+4)/(-2*x(1)+x(2)+3);
h = @(x) f{1}(x) * f{2}(x);
g = @(x)-1;
A = [-1 0; 0 -1; 1 0; 0 1; 1 1];
b = [0;0;1;1;1.5];
paddingbd = [10;10];
epsilon = 1e-5;
hatd= [1;1];

case 6
f{1} = @(x) -x(1) / (x(1)^2+x(2)^2+1);
f{2} = @(x) -x(2) / (x(1)+x(2)+1);
h = @(x) f{1}(x) + f{2}(x);
g = @(x) -1;
A = [1 1; -1 0; 0 -1];
b = [1; 0; 0];
epsilon = 1e-5;
hatd = [1; 1];

case 7
f{1} = @(x) (-x(1)^2 - x(2)^2 - 0.4 * x(1) + 4 * x(2));
f{2} = @(x) min(0.5*x(1) + 0.25*x(2) + 0.2, 2*x(1) - 4.6*x(2) + 5.8);
h = @(x) x(1) + x(2)^2;
g = @(x) 0.5 * (x(1) - 1)^2 + 1.4 * (x(2) - 0.5)^2 - 1.1;
A = [1 -2; -1 1; 2 1; 2 5; -1 -1; -1 0; 0 -1];
b = [1; 1; 4; 10; -1.5; 0; 0];
epsilon = 1e-5;
hatd = [1; 1];

case 8
delta = 1e-7;
f{1} = @(x) -5*x(1)-x(2)-7*x(3)-x(4)-4*x(5)-9*x(6)+4*x(8)+3*x(9)-7*x(10);
f{2} = @(x) x(1)+2*x(2)+5*x(3)+4*x(4)+x(5)+6*x(6)+4*x(7)+3*x(9);
f{3} = @(x) 3*x(1)+3*x(2)-4*x(4)-x(6)+2*x(7)-x(8)-4*x(9);
h = @(x) 4*x(1)-8*x(2)-3*x(3)-x(4)-7*x(5)-6*x(7)-2*x(8)+9*x(9)-3*x(10);
g{1} = @(x) -1*x(1)+1*x(2)+2*x(3)+4*x(4)-4*x(5)+4*x(6)-1*x(7)-4*x(8)-6*x(9)+3*x(10)+14+delta;
g{2} = @(x) 4*x(1)+9*x(2)-1*x(4)-2*x(5)+1*x(6)-6*x(7)+5*x(8)-89+delta;
A = [7 1 -3 -7 0 9 2 1 -5 1;
    -5 8 -1 7 5 0 -1 -3 4 0;
    2 -1 0 -2 3 -2 2 -5 -1 -3;
    -1 -4 2 9 -4 3 -3 4 0 -2;
    -3 -1 0 8 -3 -1 -2 -2 5 -5;
    2 -9 1 2 -2 -1 -4 1 -5 -2;
    2 -3 -2 -4 -5 -4 -1 9 2 1;
    4 8 -1 -1 5 -3 2 0 2 -9;
    -2 -7 1 2 5 9 -4 1 2 0;
    -2 -3 1 1 -4 -3 1 0 0 6;
    6 0 0 0 4 -3 2 2 -4 6;
    -2 -2 -3 5 -6 4 0 0 1 4;
    1 -4 -4 -6 0 -3 4 -2 4 1;
    -1 0 0 0 0 0 0 0 0 0;
    0 -1 0 0 0 0 0 0 0 0;
    0 0 -1 0 0 0 0 0 0 0;
    0 0 0 -1 0 0 0 0 0 0;
    0 0 0 0 -1 0 0 0 0 0;
    0 0 0 0 0 -1 0 0 0 0;
    0 0 0 0 0 0 -1 0 0 0;
    0 0 0 0 0 0 0 -1 0 0;
    0 0 0 0 0 0 0 0 -1 0;
    0 0 0 0 0 0 0 0 0 -1;];
b = [-66; 150; -81; 79; 53;
    -126; -12; 52; 23; -2; 23; 28; -90;
    0; 0; 0; 0; 0; 0; 0; 0; 0; 0;];
b = b - delta;
epsilon = 1e-5;
hatd = [1; 1; 1];

case 9
f{1} = @(x) -x(1)/(x(1) + x(2));
f{2} = @(x) -(-x(1) + 6) / (x(1) - x(2) +3);
h = @(x) -x(1) - x(2);
g = @(x)  -x(1) - 2*x(2)-2;
A = [
    -1 -2;
    -1 1;
    1 0;
    -1 0;
    0 -1;];
b = [-2;1;6; 0; 0];
epsilon=1e-2;
hatd = [1;1];

case 10
f{1} = @(x) x(1);
f{2} = @(x) x(2);
h = @(x) x(1) - 0.9;
%g{1} = @(x) -x(1) - x(2) - 1;
g = @(x) x(1)^2 + x(2)^2 - 0.81;
A = [1 0;
     0 1;
    -1 0;
    0 -1;
    -1 -1];
b = [1.0;1.0;1.0;1.0; 1.0];
epsilon = 1e-2;
hatd = [1.111;1];

case 11
f{1} = @(x) x(1)^2 + x(2)^2 + x(3)^2 + x(4)^2 + x(5)^2 + x(6)^2 + x(7)^2 + x(8)^2 + x(9)^2 + x(10)^2 + x(11)^2 + x(12)^2 + x(13)^2 + x(14)^2;
f{2} = @(x) (x(1) - 0.5)^2 + x(2)^2 + x(3)^2 + x(4)^2 + x(5)^2 + x(6)^2 + x(7)^2 + x(8)^2 + x(9)^2 + x(10)^2 + x(11)^2 + x(12)^2 + x(13)^2 + x(14)^2;
h = @(x) (x(1) - 1)^2 + x(2)^2 + x(3)^2 + x(4)^2 + x(5)^2 + x(6)^2 + x(7)^2 + x(8)^2 + x(9)^2 + x(10)^2 + x(11)^2 + x(12)^2 + x(13)^2 + x(14)^2 +0.25;
g = @(x)  - 0.5;
A = [ 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1;
    -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1, 0;
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -1;
    ];
b = [2; 2; 2; 2; 2; 2; 2; 2; 2; 2; 2; 2; 2; 2; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1; 1];
epsilon = 1e-5;
hatd = [1;1];

case 12
f{1} =@(x) (2*x(1) + 5*x(2) + 3*x(3) + 10)/(3*x(2) + 3*x(3) + 10) + (x(4) + x(5));
f{2} =@(x) (2*x(1) + 4*x(2) + 10) / (4*x(1) + 4*x(2) + 5*x(3) + 10) + (x(4) + x(5));
f{3} =@(x) (x(1) + 2*x(2) + 5*x(3) + 10) / (x(1) + 5*x(2) + 5*x(3) + 10) + (x(4) + x(5));
f{4} =@(x) (x(1) + 2*x(2) + 4*x(3) + 10) / (5*x(2) + 4*x(3) + 10) + (x(4) + x(5));
h = @(x) (x(1)^2 + 2*x(2)^2 +10*x(4)^2 + x(5)^2)/ (x(1)+ x(3) + 20 + x(4));
A = [2 1 5 0 0;
    1 6 3 0 0;
    5 9 2 0 0;
    9 7 3 0 0;
    -1 0 0 0 0;
    0 -1 0 0 0;
    0 0 -1 0 0;
    0 0 0 -1 0;
    0 0 0 0 -1];
b = [10; 10; 10; 10; 0; 0; 0; 0; 0];
g{1} = @(x) x(3) +x(2)-5*x(4)-1 -x(5);
g{2} = @(x) -x(3) - x(2) -2*x(4) +2 + -x(5);
%g = @(x) -1;
epsilon = 1e-2;
hatd = [1;1;1;1];
otherwise
    warning('No problem set selected')
end

% Additional auto-generated variables
options = optimset('Display','off','Algorithm','sqp');
n = size(A, 2); % number of dimensions of space X
p = length(f); % number of dimensions of space Y
if isempty(hatd)
   hatd = ones(p, 1); 
end